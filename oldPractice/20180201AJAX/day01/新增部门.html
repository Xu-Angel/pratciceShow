<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
            .error{color: red;}
            .success{color: green;}
        </style>
</head>
<body>
        <form action="" method="post">
                <div>
                    <span class="label">部门号：</span>
                    <input type="text" name="deptno"/>
                    <span class="msg"></span>
                </div>
                <div>
                    <span class="label">部门名：</span>
                    <input type="text" name="dname"/>
                    <span class="msg"></span>
                </div>
                <div>
                    <span class="label">部门位置：</span>
                    <input type="text" name="loc"/>
                    <span class="msg"></span>
                </div>
                <div>
                    <button class="cancel">取消</button>
                    <button class="save">保存</button>
                </div>
            </form>
    <script>
    
    var deptno=document.querySelectorAll('input')[0];
    deptno.addEventListener('blur',function(){

    //1获取内容
   var val=deptno.value;
    //2创建AJAX请求
    var xhr=new XMLHttpRequest()
    //3打开连接
    var url='http://localhost:8080/webserver/dept?act=checkdeptno&deptno=' + val;
    xhr.open('get',url,true);
    //4发送连接
    xhr.send();
    //5设置状态改变的业务回调函数
    xhr.onreadystatechange=function(){
        if(xhr.readyState==4 && xhr.status==200){
         //获取服务器响应的数据
         var rs=xhr.responseText;
         //解析数据为JSON
         var json=JSON.parse(re);
         //根据响应的结果修改你的页面
         var span=deptno.nextElementSibling;
         span.innerHTML=json.msg;
         span.className=json.statusCode==1?'msg error':'msg success';
         //
        }
    }
    })

    </script>
</body>
</html>